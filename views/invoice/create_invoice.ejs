<!DOCTYPE html>
<html lang="en">
<!-- Head -->
<%- include('../partials/head.ejs') %>
<head>
    <link rel="stylesheet" href="/styles/new.css">
    <script src="/scripts/create.js" defer></script>
</head>

<body>
    <!-- Navbar -->
    <%- include('../partials/nav.ejs') %> 

    <main>
        <a href="/" class="back">
            <img src="/svgs/arrow-left.svg" alt="arrow left">
            <span>Go back</span>
        </a>
        <h1>New Invoice</h1>

        <% if(invoice) { %>
            <form id="edit-form">
                <div class="from">
                    <h4>Bill from</h4>
                    <label for="from_address">Street Address</label>
                    <input type="text" name="from_address" value="<%= invoice.from.address %>" required>
            
                    <label for="from_city">City</label>
                    <input type="text" name="from_city"  value="<%= invoice.from.city %>" required>
            
                    <label for="from_post_code">Post Code</label>
                    <input type="text" name="from_post_code" value="<%= invoice.from.postCode %>" required>
            
                    <label for="from_country">Country</label>
                    <input type="text" name="from_country" value="<%= invoice.from.country %>" required>
                </div>
                <div class="to">
                    <h4>Bill to</h4>
                    <label for="name">Name</label>
                    <input type="text" name="name" value="<%= invoice.client.name %>" required>
            
                    <label for="email">Email</label>
                    <input type="email" name="email" value="<%= invoice.client.email %>" required>
            
                    <label for="address">Street Address</label>
                    <input type="text" name="address" value="<%= invoice.client.address %>" required>
            
                    <label for="city">City</label>
                    <input type="text" name="city" value="<%= invoice.client.city %>" required>
            
                    <label for="post_code">Post Code</label>
                    <input type="text" name="post_code" value="<%= invoice.client.postCode %>" required>
            
                    <label for="country">Country</label>
                    <input type="text" name="country" value="<%= invoice.client.country %>" required>
            
                    <label for="inv_date">Invoice Date</label>
                    <input type="date" name="inv_date" value="<%= date %>" required>
            
                    <select name="term">
                        <option value="1">Net 1 Day</option>
                        <option value="7">Net 7 Days</option>
                    </select>
            
                    <label for="description">Project / Description</label>
                    <input type="text" name="description" value="<%= invoice.invoice.description %>" required>
                </div>
                <div  class="item">  
                    <label for="item_name">Item Name</label>
                    <input type="text" name="item_name" value="<%= invoice.items.name %>" required>
            
                    <label for="qty">Qty</label>
                    <input type="number" name="qty"  value="<%= invoice.items.qty %>" required>
            
                    <label for="price">Price</label>
                    <input type="number" name="price"  value="<%= invoice.items.price %>" required>
            
                    <label for="total">Total</label>
                    <input type="number" name="total" disabled>
            
                    <button type="button">Add a new item</button>
                </div>

                <input type="hidden" value="<%= invoice._id %>" name="_id">
            
                <button type="button">Cancel</button>
                <button type="submit">Save changes</button>
            
            </form>
        <% }else{ %> 
            <form action="/invoice" method="post" id="create-form">
                <div class="from">
                    <h4>Bill from</h4>
                    <label for="from_address">Street Address</label>
                    <input type="text" name="from_address" required>
                    
                    <div class="group">
                        <div class="inp-group">
                            <label for="from_city">City</label>
                            <input type="text" name="from_city" required>
                        </div>

                        <div class="inp-group">
                            <label for="from_post_code">Post Code</label>
                            <input type="text" name="from_post_code" required>
                        </div>
                    </div>
            
                    <label for="from_country">Country</label>
                    <input type="text" name="from_country" required>
                </div>
                <div class="to">
                    <h4>Bill to</h4>
                    <label for="name">Name</label>
                    <input type="text" name="name" required>
            
                    <label for="email">Email</label>
                    <input type="email" name="email" required>
            
                    <label for="address">Street Address</label>
                    <input type="text" name="address" required>
                    
                    <div class="group">
                        <div class="inp-group">
                            <label for="city">City</label>
                            <input type="text" name="city" required>
                        </div>

                        <div class="inp-group">
                            <label for="post_code">Post Code</label>
                            <input type="text" name="post_code" required>
                        </div>
                    </div>
                                
                    <label for="country">Country</label>
                    <input type="text" name="country" required>
            
                    <label for="inv_date">Invoice Date</label>
                    <input type="date" name="inv_date" required>
            
                    <label for="term">Payment Terms</label>
                    <select name="term">
                        <option value="1">Net 1 Day</option>
                        <option value="7">Net 7 Days</option>
                    </select>
            
                    <label for="description">Project / Description</label>
                    <input type="text" name="description" required>
                </div>

                <div class="items">
                    <h3>Item List</h3>

                    <div class="item">
                        <label for="item_name">Item Name</label>
                        <input type="text" class="item-name" name="item_name" required>
                    
                        <div class="item-group">
                            <div>
                                <label for="qty">Qty</label>
                                <input type="number" value="0" class="qty" name="qty" required>
                            </div>
                    
                            <div>
                                <label for="price">Price</label>
                                <input type="number" value="0.00" class="price" name="price" required>
                            </div>
                    
                            <div>
                                <label for="total">Total</label>
                                <div id="total" class="total">0.00</div>
                            </div>
                    
                            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="16" class="thrash">
                                <path
                                    d="M11.583 3.556v10.666c0 .982-.795 1.778-1.777 1.778H2.694a1.777 1.777 0 01-1.777-1.778V3.556h10.666zM8.473 0l.888.889h3.111v1.778H.028V.889h3.11L4.029 0h4.444z"
                                    fill="#888EB0" fill-rule="nonzero" />
                            </svg>
                        </div>
                    </div>

                    <div id="second-item" class="item hidden">
                        <label for="item_name">Item Name</label>
                        <input type="text" class="item-name" name="item_name" required>
                    
                        <div class="item-group">
                            <div>
                                <label for="qty">Qty</label>
                                <input type="number" value="0" class="qty" name="qty" required>
                            </div>
                    
                            <div>
                                <label for="price">Price</label>
                                <input type="number" value="0.00" class="price" name="price" required>
                            </div>
                    
                            <div>
                                <label for="total">Total</label>
                                <div id="total" class="total">0.00</div>
                            </div>
                    
                            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="16" class="thrash">
                                <path
                                    d="M11.583 3.556v10.666c0 .982-.795 1.778-1.777 1.778H2.694a1.777 1.777 0 01-1.777-1.778V3.556h10.666zM8.473 0l.888.889h3.111v1.778H.028V.889h3.11L4.029 0h4.444z"
                                    fill="#888EB0" fill-rule="nonzero" />
                            </svg>
                        </div>
                    </div>
            
                    <button type="button" id="add-item">Add a new item</button>
                </div>  
                
                <button type="submit" class="hidden" id="submit">Submit</button>
            </form>
        <% } %>  
    </main>

    <section class="form_actions">
        <button id="discard" class="discard">Discard</button>
        <button id="save-draft" class="draft">Save as draft</button>
        <button id="save" class="save">Save & end</button>
    </section>
</body>

</html>